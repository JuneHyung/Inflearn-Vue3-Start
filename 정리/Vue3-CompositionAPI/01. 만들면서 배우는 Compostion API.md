# 01. ë§Œë“¤ë©´ì„œ ë°°ìš°ëŠ” Compostion API

## 01-01. í• ì¼ ê´€ë¦¬ ì•± ì†ŒìŠ¤ ì½”ë“œ ì•ˆë‚´

ì¤‘ê¸‰ê°•ì˜ì˜ TodoListë¥¼ í™œìš©. 

ë‹¤ì‹œ ë§Œë“¤ë©´ì„œ ì§„í–‰.

vue-intermediate ë ˆí¬ì§€í† ë¦¬ì˜ ë¸Œëœì¹˜ ì°¸ê³ .



## 01-02. í”„ë¡œì íŠ¸ ìƒì„± ë° í—¤ë” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

í”„ë¡œì íŠ¸ëŠ” vue3-todoì—ì„œ ì§„í–‰. (style ë³´ë‹¤ëŠ” compositionì— ëŒ€í•´ì„œ ì§‘ì¤‘.)

ì—¬ê¸°ì„œ vue3ì˜ íŠ¹ì§•ì„ í•˜ë‚˜ ì‚´í´ë³´ê³  ê°€ì.

vue3ì—ì„œëŠ” ë£¨íŠ¸ ì—˜ë¦¬ë¨¼íŠ¸ê°€ í•œ ê°œê°€ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œë„ ê°€ëŠ¥. (Reactì˜ Fragmentì²˜ëŸ¼.)

```vue
<template>
  <TodoHeader />
  <TodoInput />
  <TodoList />
</template>

```

ì´ 3ê°œì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•  ê²ƒì´ë‹¤.

â— ì»´í¬ë„ŒíŠ¸ ìƒì„± ì‹œ íŒŒì¼ì´ë¦„ì€ ì½”ë“œìŠ¤íƒ€ì¼ê°€ì´ë“œë¥¼ ì°¸ê³ .



```vue
// TodoHeader
<template>
  <h1>Todo App</h1>
</template>
```



### ğŸ“˜ ì°¸ê³ 

* [vue ê³µì‹ë¬¸ì„œ - Style Guide](https://vuejs.org/style-guide/)



## 01-03. í• ì¼ ê´€ë¦¬ ì¸í’‹ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

TodoInput ì»´í¬ë„ŒíŠ¸ ìƒì„±í•´ë³´ì.

```vue
// TodoInput
<template>
  <div>
    <input type="text">
    <button>ì¶”ê°€</button>
  </div>
</template>

<script>
  export default {
    
  }
</script>
```



ë²„íŠ¼ê³¼ ë‚´ìš©ì„ ì œì–´í•˜ë„ë¡ scriptì— ì‘ì„±í•´ë³´ì.<br/>(ì•„ì´í…œ ì €ì¥ì€ localStorageì—)

```vue
// TodoInput
<template>
  <div>
    <input type="text" v-model="todoInput">
    <button @click="addTodo">ì¶”ê°€</button>
  </div>
</template>

<script>
import { ref } from 'vue';

  export default {
    setup(){
      // data
      const todoInput = ref('');

      // methods
      function addTodo(){
        const todo = todoInput.value;
        localStorage.setItem(todo, todo);
      }
      return{
        todoInput,
        addTodo
      }
    }
  }
</script>
```

â— ì‘ì„±ì‹œí•˜ë©° ì´ì „ ë‚´ìš©ë“¤ì„ ìƒê°í•´ë³´ê¸°

* v-model : refë¡œ ë°˜ì‘ì„±ì„ ì£¼ì—ˆì§€ë§Œ, templateì—ì„œ .valueë¡œ ë°”ì¸ë”©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. => vue3ì—ì„œ ê¸°ì¡´ì˜ ì‚¬ìš© ê²½í—˜ì„ í•´ì¹˜ì§€ ì•Šê¸° ìœ„í•´ .valueì— ì ‘ê·¼í•˜ë„ë¡ ê°œë°œí•´ë‘ .
* return : setupì—ì„œ ì‘ì„±í•œ ë‚´ìš©ì€ returnì„ í•´ì•¼ ë°–(template)ì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.



## 01-04. í• ì¼ ê´€ë¦¬ ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

TodoList ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì.

```vue
<template>
  <ul>
    <li v-for="(item, idx) in items" :key="idx">
      {{ item }}
    </li>
  </ul>  
</template>

<script>
import { ref } from 'vue'
  export default {
    setup(){
      const items = ref(['ì• í”Œ', 'ì‚¼ì„±', 'ì¸í”„ëŸ°'])
      return {items}
    }
  }
</script>
```

itemsë¼ëŠ” listë¥¼ ë°˜ë³µí•˜ì—¬ ë¦¬ìŠ¤íŠ¸ë¡œ ë‚˜íƒ€ë‚´ëŠ” ì»´í¬ë„ŒíŠ¸.



## 01-05.  í• ì¼ ê´€ë¦¬ ëª©ë¡ í‘œì‹œ ê¸°ëŠ¥ êµ¬í˜„

TodoListì—ì„œ inputì—ì„œ ë°›ì€ ì‹¤ì§ˆì ì¸ ë°ì´í„°ë¥¼ ë¦¬ìŠ¤íŠ¸ì— ë¿Œë¦¬ë„ë¡ ìˆ˜ì •.

í˜„ì¬ localStorageì— ì €ì¥ì¤‘ì¸ë° ì´ê±¸ ê°€ì ¸ì™€ ë¿Œë¦¬ëŠ” í˜•ì‹ìœ¼ë¡œ ìˆ˜ì •í•´ë³´ì.

```vue
// TodoList
<template>
...
</template>

<script>
import { ref } from 'vue'
  export default {
    setup(){
      const items = ref([])

      // methods
      function fetchTodos(){
        for(let i=0;i<localStorage.length;i++){
          const todoItem = localStorage.key(i);
          items.value.push(todoItem);
        }
      }

      fetchTodos();
      
      return {items, fetchTodos}
    }
  }
</script>
```

* localStorageë¥¼ ìˆœíšŒí•˜ë©° ëª¨ë“  ê°’ë“¤ì„ itemsì— ë„£ì–´ì¤€ë‹¤.
* í•¨ìˆ˜ìƒì„± í›„ ë°”ë¡œ ì‹¤í–‰.



## 01-06. í• ì¼ ì¶”ê°€, ì¡°íšŒ ê¸°ëŠ¥ ë¦¬íŒ©í† ë§

TodoInputì— ê°’ì„ ì…ë ¥í–ˆì„ ë–„ ë°”ë¡œ TodoListê¹Œì§€ ì „ë‹¬ë˜ë„ë¡ ì¸í’‹ì˜ ë¡œì§ì„ ìˆ˜ì •.

emitì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì˜®ê¸¸ ê²ƒì´ë‹¤.

```vue
// í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì˜ ë‚´ìš©
this.$emit('ì´ë²¤íŠ¸ ëª…');

// ----------------------------------------------------------------------------------------------

<!-- ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì˜ í…œí”Œë¦¿ -->
<div id="app">
  <child-component v-on:ì´ë²¤íŠ¸ ëª…="ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì˜ ì‹¤í–‰í•  ë©”ì„œë“œ ëª… ë˜ëŠ” ì—°ì‚°"></child-component>
</div>

```

ê¸°ì¡´ì— ìœ„ ì½”ë“œì²˜ëŸ¼ ì‘ì„±í–ˆëŠ”ë° ì´ëŠ” `ì˜µì…˜ ì†ì„±`ì—ì„œ ìœ íš¨í•œ ë¬¸ë²•ì´ë‹¤.

compositionì—ì„œ ì•Œì•„ë³´ì.

```vue
context.emit('change'); // change ì´ë²¤íŠ¸ë§Œ ë°œìƒ
context.emit('change', 100); // change ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ê³  ì¸ì 100ì„ ê°™ì´ ë„˜ê¹€

// ----------------------------------------------------------------------------------------------

<script>
export default {
  setup(props, context) {
    context.emit('change');
  }
}
</script>
```

* setupì€ ê¸°ë³¸ì ìœ¼ë¡œ 2ê°œì˜ íŒŒë¼ë¯¸í„° `props`ì™€ `context`ë¥¼ ë°›ê³  ìˆë‹¤. emitì€ context ì•ˆì— ì¡´ì¬í•œë‹¤.



Inputì—ì„œ addTodoë©”ì„œë“œì— emitì„ ì¶”ê°€í•´ Appì»´í¬ë„ŒíŠ¸ì— íŒŒë¼ë¯¸í„°ê°€ ì˜¬ë¼ê°€ë„ë¡ ìˆ˜ì •.

```vue
<template>
...
</template>

<script>
import { ref } from 'vue';

  export default {
    setup(props, context){
      // data
      const todoInput = ref('');

      // methods
      function addTodo(){
        const todo = todoInput.value;
        localStorage.setItem(todo, todo);
        
        context.emit('add', todo);
        clearTodo();
      }

      const clearTodo = () => todoInput.value = '';
      return{
        todoInput,
        addTodo
      }
    }
  }
</script>
```

ì¶”ê°€ë¥¼ ëˆ„ë¥´ë©´ ì…ë ¥ê°’ì´ ì´ˆê¸°í™” ë˜ê³ , localStorageì— ì¶”ê°€ë˜ëŠ”ê²ƒ í™•ì¸ê°€ëŠ¥. ë˜ Timelineì„ ì‚´í´ë³´ë©´ ì–´ë–¤ê²Œ ë°œìƒí–ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.



Appì—ì„œ ì´ ê°’ì„ ë°›ì•„ì„œ ì¶”ê°€í•˜ëŠ” ê²ƒì„ êµ¬í˜„í•´ë³´ì.

```vue
<template>
	<TodoInput @í•˜ìœ„ì»´í¬ë„ŒíŠ¸ì˜ ì´ë²¤íŠ¸ ì´ë¦„ = "ìƒìœ„ì»´í¬ë„ŒíŠ¸ì˜ ë©”ì„œë“œ ì´ë¦„" />
</template>
```

ì´ì™€ ê°™ì€ í˜•íƒœë¡œ ì‘ì„±.

```vue
// App
<template>
  <TodoHeader />
  <TodoInput @add="addTodoItem"/>
  <TodoList :todoItems="todoItems"/>
</template>

<script>
import { ref } from 'vue';
import TodoHeader from './components/TodoHeader.vue'
import TodoInput from './components/TodoInput.vue';
import TodoList from './components/TodoList.vue';
export default {
  components: { TodoHeader, TodoInput, TodoList },
  setup(){
    const todoItems = ref([])

    // methods
    function fetchTodos(){
      const result = [];
      for(let i=0;i<localStorage.length;i++){
        const todoItem = localStorage.key(i);
        result.push(todoItem);
      }
      return result;
    }

    todoItems.value = fetchTodos();


    function addTodoItem(todo){
      todoItems.value.push(todo);
      localStorage.add(todo, todo)
    }
    return {todoItems, fetchTodos, addTodoItem}
  }
}
</script>
```

TodoInputì˜ localStorageì— ì €ì¥í•˜ëŠ” ë¶€ë¶„ì€ Appì—ì„œ emitìœ¼ë¡œ ì˜¬ë¼ì˜¨ê±¸ ë°›ìœ¼ë©´ì„œ ë™ì‘í•˜ë‹ˆ ì‚­ì œ.



## ğŸ“˜ ì°¸ê³ 

* [Cracking Vue - Event Emit](https://joshua1988.github.io/vue-camp/vue/event-emit.html)
* [Cracking Vue - Event Emit in setup](https://joshua1988.github.io/vue-camp/composition/event-emit.html)



## 01-07. í• ì¼ ì‚­ì œ ê¸°ëŠ¥ êµ¬í˜„

ì‚­ì œê¸°ëŠ¥ êµ¬í˜„ì„ í•´ë³´ì. ì´ë¥¼ ìœ„í•´ ì‚­ì œ ë²„íŠ¼ì„ ì¶”ê°€í•˜ì.

todoListì—ì„œ ë²„íŠ¼ í´ë¦­ì‹œ í•´ë‹¹ ì•„ì´í…œì˜ ì •ë³´ë¥¼ emitìœ¼ë¡œ ì˜¬ë¦¬ê³ , App.vueì—ì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆ˜ì •í•˜ëŠ” ë°©ì‹

```vue
// TodoList
<template>
  <ul>
    <li v-for="(item, idx) in todoItems" :key="idx">
      <span>{{ item }}</span>
      <button @click="removeTodo(item, idx)">ì‚­ì œ</button>
    </li>
  </ul>  
</template>

<script>
  export default {
    props: ['todoItems'],
    setup(porops, context){
      function removeTodo(item, idx){
        context.emit('remove', item, idx)
      }
      return {removeTodo}
    }
  }
</script>
```



```vue
// App
<template>
  <TodoHeader />
  <TodoInput @add="addTodoItem"/>
  <TodoList :todoItems="todoItems" @remove="removeTodoItem"/>
</template>

<script>
import { ref } from 'vue';
...
export default {
  components: { TodoHeader, TodoInput, TodoList },
  setup(){
  	...
  	function removeTodoItems(item, idx){
      todoItems.value.splice(idx, 1);
      localStorage.removeItem(item);
    }
    return {todoItems, fetchTodos, addTodoItem, removeTodoItem}
  }
}
</script>
```



â— setupê³¼ methodë¥¼ ê°™ì´ ì‚¬ìš©í• ë–„

```vue
<script>
export default {
  setup(){
    const todoItems = ref([])
    ...
  }
  methods: {
    removeTodoItems(item, idx){
      this.todoItems.splice(idx, 1);
      localStorage.removeItem(item);
    }
  }
}
</script>
```

setupì—ì„œ `todoItems = ref([])`ê°€ ì˜µì…˜ ì†ì„±ì˜dataì— ì„ ì–¸í•œ ê²ƒê³¼ ë™ì¼í•˜ë¯€ë¡œ this.todoItemsë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.

â— ì»´í¬ë„ŒíŠ¸ê°€ ë§ì´ ë³µì¡í•´ì§€ë©´ setupì„ ì´ìš©í•˜ê³ , ë¡œì§ì„ ë¶„ë¦¬í•˜ê¸°ë¥¼ ì¶”ì²œí•˜ê³ , setupì´ í•„ìˆ˜ê°€ì•„ë‹ˆë¼ êµ¬ê°„ì— ë„£ì„ ìˆ˜ë„ìˆë‹¤ëŠ”ê±¸ ì•Œì•„ë‘ê¸°.

