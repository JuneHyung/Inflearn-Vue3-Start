# 02. Vue Composition API í™œìš©

## 02-01. setup()ì—ì„œ .valueë¡œ ì ‘ê·¼í•˜ëŠ” ì´ìœ 

ì™œ refë¡œ ì„¤ì •í•œ ê°’ì´ `.value`ë¡œ ì ‘ê·¼ë˜ì•¼í•˜ëŠ”ì§€ ì‚´í´ë³´ì.

íŠ¹ì • ê°’ì´ ë³€ê²½ë˜ì–´ ì¶”ì í•˜ë ¤ë©´ Object Defined Propertyë¼ë˜ì§€ Proxyë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.

refë¥¼ ì»ì„ ë–„ ê°’ì´ ë³€ê²½ë˜ë©´ ê·¸ ê°’ì„ ì¶”ì í•˜ê¸°ìœ„í•´ refë¥¼ ì‚¬ìš©í•œë‹¤.



ê³µì‹ ë¬¸ì„œì˜ sudo ì½”ë“œë¥¼ ì‚´í´ë³´ì.

```javascript
// pseudo code, not actual implementation
const myRef = {
  _value: 0,
  get value() {
    track()
    return this._value
  },
  set value(newValue) {
    this._value = newValue
    trigger()
  }
}
```

setupì—ì„œ reactivityê°€ ì£¼ì…ëœ ê°’ì„ ë³€ê²½í•˜ë©´ ìœ„ì˜ ë‚´ìš©ì„ í†µí•´ ê°’ì´ ë³€ê²½ëœë‹¤ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.

ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë³€ê²½ì´ë‚˜ ì ‘ê·¼ ì‹œ í•­ìƒ `.value`ë¡œ ì ‘ê·¼í•´ì•¼ í•œë‹¤.



ê·¸ëŸ°ë° templateì—ì„œëŠ” .valueë¥¼ ë¶™ì´ì§€ ì•Šì•„ë„ ëœë‹¤.

```vue
<template>
	<div>{{message}}</div>
</template>
```

### why?

**ë·° ë‚´ë¶€ì ìœ¼ë¡œ messageì•ˆì— .valueê°’ì„ êº¼ë‚´ì–´ í…œí”Œë¦¿ í‘œí˜„ì‹ì— ì—°ê²°**í•´ì£¼ê¸° ë•Œë¬¸.

=> Vue2ì—ì„œ **ê°œë°œí•˜ë˜ ê²½í—˜ì„ í¬ê²Œ í•´ì¹˜ì§€ ì•Šê¸° ìœ„í•´** ê³ ì•ˆëœ ì¥ì¹˜.



### ì •ë¦¬í•´ë³´ì.

* setupì•ˆì—ì„œëŠ” reactivityê°€ ì£¼ì…ëœ ê°’ì´ í•­ìƒ .valueë¡œ ë³€ê²½ì´ë‚˜ ì ‘ê·¼ì´ ë˜ì•¼í•œë‹¤.
* .valueê°’ì´ ë°”ë€œì— ë”°ë¼ íŠ¹ì • ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´ vue ë‚´ë¶€ì ìœ¼ë¡œ _value, get, setì˜ êµ¬ì¡°ë¥¼ ê°€ì§„ë‹¤.
* returnëœ ë°ì´í„°ëŠ” ê¸°ì¡´ì˜ vueì‚¬ìš© ê²½í—˜ì„ í•´ì¹˜ì§€ ì•Šê¸°ìœ„í•´ templateì—ì„œ .valueë¥¼ ì‚¬ìš©í•˜ì§€ì•Šì•„ë„ í…œí”Œë¦¿ í‘œí˜„ì‹ê³¼ ì—°ê²°ë˜ê²Œ ê°œë°œë˜ìˆë‹¤.



### ğŸ“˜ ì°¸ê³ 

* [Vue ê³µì‹ë¬¸ì„œ - Reactivity Fundamentals](https://vuejs.org/guide/essentials/reactivity-fundamentals.html#reactivity-fundamentals)

* [Cracking Vue - ref ì†Œê°œ](https://joshua1988.github.io/vue-camp/reuse/composition.html#ref-ì†Œê°œ)



## 02-02. computed API ì†Œê°œ

computed apiëŠ” vue3ì—ì„œ ë‚˜ì˜¨ ìƒˆë¡œìš´ ì†ì„±. 

ì´ê²ƒ ìì²´ê°€ ìƒˆë¡œë‚˜ì˜¨ê²Œ ì•„ë‹ˆë¼ composition apiì—ì„œ ì‚¬ìš©ëœ computedì†ì„±ì„ ì˜ë¯¸í•¨.

> computed ì†ì„±
>
> í…œí”Œë¦¿ í‘œí˜„ì‹ì˜ ì½”ë“œë¥¼ ê°„ê²°í•˜ê²Œ í•´ì£¼ê³ , APIì—ì„œ ë°›ì€ ë°ì´í„°ë¥¼ ê°€ê³µí•  ë–„ ì—°ì‚° ë¡œì§ì„ ë‹¨ìˆœí™” í•´ì¤€ë‹¤.



Appì»´í¬ë„ŒíŠ¸ì—ì„œ í—¤ë” ì»´í¬ë„ŒíŠ¸ë¡œ íƒ€ì´í‹€ì„ í•˜ë‚˜ ë‚´ë¦¬ê³ , ê·¸ íƒ€ì´í‹€ì„ computedë¡œ ë°”ê¿”ë³´ëŠ” ì˜ˆì œë¡œ ì•Œì•„ë³´ì.

```vue
// App.vue
<template>
  <TodoHeader :appTitle="title"/>
</template>

<script>
export default {
  data(){
    return {
      title: 'í• ì¼ ì•±'
    }
  }
}
</script>
```

```vue
// TodoHeader
<template>
  <h1>{{ appTitle }}</h1>
</template>

<script>
  export default {
    props: ['appTitle']
  }
</script>
```



TodoHeaderì— computedë¥¼ ì¶”ê°€í•´ë³´ì.

```vue
<template>
  <h1>{{ appTitle }}</h1>
	<h4>{{ newTitle }}</h4>	
</template>

<script>
import { computed } from 'vue'
  export default {
    props: ['appTitle'],
    setup(props){
      const newTitle = computed(()=>{
        return props.appTitle + '!!'
      })
      return {newTitle}
    }
  }
</script>
```

ì´ë ‡ê²Œ propsì˜ ê°’ì„ ê³„ì‚°í•´ íŠ¹ì • ê°’ìœ¼ë¡œ ë³€í•˜ëŠ” ê²ƒì´ ë°”ë¡œ computedë¼ëŠ” ì†ì„±ì´ê³ , ì´ë¥¼ setupì•ˆì—ì„œ computed APIë¼ ë¶€ë¥¸ë‹¤.



### ğŸ“˜ ì°¸ê³ 

* [ Cracking Vue - computed API](https://joshua1988.github.io/vue-camp/composition/computed.html)





## 02-03. setup()ì—ì„œ props ì†ì„± ì‚¬ìš©ì‹œ ì£¼ì˜í•  ì 

setupì˜ ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¡œ propsê°€ ë„˜ì–´ì˜¤ëŠ” ê²ƒì„ ë´¤ì—ˆë‹¤.

ê·¸ ì™¸ì—ë„ propsì‚¬ìš©ì‹œ ì£¼ì˜í•  ì ì— ëŒ€í•´ ì•Œì•„ë³´ì.

```vue
// TodoList.vue
<template>
  <ul>
    <li v-for="(item, idx) in todoItems" :key="idx">
      <span>{{ item }}</span>
      <buton>ì‚­ì œ</buton>
    </li>
  </ul>  
</template>

<script>
  export default {
    props: ['todoItems'],
    setup(props, context){
      function removeTodo(item, index){
        context.emit('remove', item, index);
      }
      return {removeTodo}
    }
  }
</script>

<style lang="scss" scoped>

</style>
```

todoItemsë¼ëŠ” propsê°’ìœ¼ë¡œ í™”ë©´ì— í‘œì‹œí•˜ê³ ìˆì—ˆë‹¤.

propsë¡œ ë°›ì€ ê°’ì„ ë°”ë¡œ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— setupì•ˆì—ì„œ ì–´ë–»ê²Œ ë‹¤ë¤„ì•¼í•˜ëŠ”ì§€ ë³¼ í•„ìš”ê°€ ì—†ì—ˆë‹¤.

ì´ë²ˆì— ì•Œì•„ ë³¼ê²ƒì€ setupì˜ ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì˜ propsì“¸ë•Œ ì£¼ì˜ì ì´ë‹¤.



```javascript
<script>
  export default {
    props: ['todoItems', 'userId'],
    setup(props, context){
      ...
      return {...}
    }
  }
</script>
```

ë¨¼ì €, propsì— userIdë¼ê³  í•˜ë‚˜ ë” ë°›ì.<br/>ê·¸ë ‡ê²Œ ë˜ë©´, propsë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ê²Œ todoItemsì™€ userId ë‘ ê°œê°€ ëœë‹¤.<br/>ê·¸ë ‡ê²Œë˜ë©´ propsë¶€ë¶„ì„ `setup({todoItems, userId}, context)` ì´ë ‡ê²Œ êµ¬ì¡°ë¶„í•´í• ë‹¹ì„í•´ì„œ ì‚¬ìš©í•  í™•ë¥ ì´ ë†’ë‹¤.

í•˜ì§€ë§Œ, ì´ë ‡ê²Œ ì‚¬ìš©í•´ì„  ì•ˆëœë‹¤.

### why?

ì´ë ‡ê²Œ ë””ìŠ¤íŠ¸ëŸ­ì²˜ë§ì„ í•˜ê²Œ ë˜ë©´, **Reactivityê°€ ì‚¬ë¼ì ¸ë²„ë ¤** dataì˜ ì‹±í¬ë¥¼ ë§ì¶”ê¸° ì–´ë ¤ì›Œì§€ê³ , ë²„ê·¸ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤.

ê·¸ë ‡ê¸° ë•Œë¬¸ì— **propsë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©**í•´ì•¼í•œë‹¤ (â— ë””ìŠ¤íŠ¸ëŸ­ì²˜ë§ ê¸ˆì§€)

ê°œë°œìë„êµ¬ì—ì„œ ê°’ì„ ë°”ê¿”ë³´ë©° í™•ì¸ ê°€ëŠ¥.



contextì†ì„±ì€?

contextëŠ” í™”ë©´ì— í‘œì‹œë˜ëŠ”ê²Œ ì•„ë‹ˆë¼, í•œë²ˆ í˜¸ì¶œë˜ê³  ëë‚˜ëŠ” ê±°ê¸° ë•Œë¬¸ì— contextì˜ emitê°™ì€ ê²½ìš°ëŠ” ë””ìŠ¤íŠ¸ëŸ­ì²˜ë§ í•´ë„ ìƒê´€ì—†ë‹¤.



### ğŸ“˜ ì°¸ê³ 

* [Cracking Vue - Props](https://joshua1988.github.io/vue-camp/composition/props.html)





## 02-04. ë·° ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ ì‚¬ì´í´

ì»´í¬ì§€ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ì‚¬ì´í´ í›…ì„ ì˜ë¯¸í•œë‹¤.

ë¨¼ì € ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ ì‚¬ì´í´ì˜ ê¸°ë³¸ì„ ì•Œì•„ë³´ê³  ê·¸ë‹¤ìŒ APIì— ëŒ€í•´ ì•Œì•„ë³´ì.



### ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ ì‚¬ì´í´

ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ì‚¬ì´í´ì€ ë·°ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ì†Œë©¸ë˜ê¸° ê¹Œì§€ ê±°ì¹˜ëŠ” ê³¼ì •ì„ ì˜ë¯¸.

- data ì†ì„±ì˜ ì´ˆê¸°í™” ë° ê´€ì°° (Reactivity ì£¼ì…)
- ë·° í…œí”Œë¦¿ ì½”ë“œ ì»´íŒŒì¼ (Virtual DOM -> DOM ë³€í™˜)
- ì¸ìŠ¤í„´ìŠ¤ë¥¼ DOMì— ë¶€ì°©

![lifecycle](./images/02_lifecycle.jpg)



vueë‚´ë¶€ì—ì„œ ì œê³µí•˜ëŠ” **Lifecycle Hook**ì„ ì œê³µí•˜ê³  ìˆë‹¤ëŠ”ê±¸ ì•Œê³ ìˆê¸°.



### ğŸ“˜ ì°¸ê³ 

* [Cracking Vue - Instance Lifecycle](https://joshua1988.github.io/vue-camp/vue/life-cycle.html)
* [Cracking Vue- Lifecycle API](https://joshua1988.github.io/vue-camp/composition/lifecycle.html)



## 02-05. Lifecycle API ì†Œê°œ

ì´ë²ˆì—” Lifecycle APIì— ëŒ€í•´ ì•Œì•„ë³´ì.

**ì»´í¬ì§€ì…˜ ìŠ¤íƒ€ì¼ë¡œ ì‘ì„±ëœ ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ ì‚¬ì´í´ í›…**ì´ë‹¤.<br/>ì¦‰, setupì•ˆì—ì„œ ì“°ëŠ” Lifecycle Hook.

| ì¸ìŠ¤í„´ìŠ¤ ë¼ì´í”„ì‚¬ì´í´ í›… | ë¼ì´í”„ì‚¬ì´í´ API | ë¹„ê³                                  |
| ------------------------ | ---------------- | ------------------------------------ |
| beforeCreate             | X                | ëŒ€ì‹  setup() ì‚¬ìš©                    |
| created                  | X                | ëŒ€ì‹  setup() ì‚¬ìš©                    |
| beforeMount              | onBeforeMount    |                                      |
| mounted                  | onMounted        |                                      |
| beforeUpdate             | onBeforeUpdate   |                                      |
| updated                  | onUpdated        |                                      |
| beforeDestroy            | onBeforeUnmount  | destory ë¼ëŠ” í‘œí˜„ì´ unmountë¡œ ë³€ê²½ë¨ |
| destroyed                | onUnmounted      | destory ë¼ëŠ” í‘œí˜„ì´ unmountë¡œ ë³€ê²½ë¨ |
| errorCaptured            | onErrorCaptured  |                                      |



**ë³€ê²½ì **

* `beforeCreate`, `created` ëŒ€ì‹ ì— `setup()` ì„ ì‚¬ìš©
* `onXX` í˜•íƒœë¡œ ì´ë¦„ì´ ë°”ë€ ì 
* `beforeDestory`, `destroyed` ë“± destory ëŒ€ì‹ ì— `onBeforeUnmount`, `onUnmounted`ë¥¼ ì‚¬ìš©



### ğŸ“˜ ì°¸ê³ 

* [Cracking Vue- Lifecycle API](https://joshua1988.github.io/vue-camp/composition/lifecycle.html)
* [Cracking Vue - Lifcecycle API ì°¨ì´](https://joshua1988.github.io/vue-camp/composition/lifecycle.html#ì¸ìŠ¤í„´ìŠ¤-ë¼ì´í”„ì‚¬ì´í´-í›…ê³¼-lifecycle-apiì˜-ì°¨ì´ì )





## 02-06. Lifecycle API ì‹¤ìŠµ





## 02-07. watch API ì†Œê°œ

watchì— ëŒ€í•´ ì•Œì•„ë³´ì. ë§ˆì°¬ê°€ì§€ë¡œ, watchì†ì„±ì„ composition APIí˜•íƒœë¡œ ì‚¬ìš©í•œ ê²ƒì´ë‹¤.





## 02-08. ì»¤ìŠ¤í…€ ì»´í¬ì§€ì…˜ í•¨ìˆ˜

## 02-09. ì»¤ìŠ¤í…€ ì»´í¬ì§€ì…˜ í•¨ìˆ˜ ì •ë¦¬



